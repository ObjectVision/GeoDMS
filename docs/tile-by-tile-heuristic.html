<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav ul li a { background-image: none; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>tile-by-tile-heuristic | GeoDMS wiki</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="tile-by-tile-heuristic" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A starter template for a Jeykll site using the Just the Docs theme!" /> <meta property="og:description" content="A starter template for a Jeykll site using the Just the Docs theme!" /> <link rel="canonical" href="http://localhost:4000/docs/tile-by-tile-heuristic.html" /> <meta property="og:url" content="http://localhost:4000/docs/tile-by-tile-heuristic.html" /> <meta property="og:site_name" content="GeoDMS wiki" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="tile-by-tile-heuristic" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A starter template for a Jeykll site using the Just the Docs theme!","headline":"tile-by-tile-heuristic","url":"http://localhost:4000/docs/tile-by-tile-heuristic.html"}</script> <!-- End Jekyll SEO tag --> <!-- Automatically display code inside script tags with type=math/tex using MathJax --> <script type="text/javascript" defer src="../assets/js/mathjax-script-type.js"> </script> <!-- Copied from https://docs.mathjax.org/en/latest/web/components/combined.html --> <script type="text/javascript" id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"> </script> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> GeoDMS wiki </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in software category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/software.html" class="nav-list-link">software</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/system-requirements.html" class="nav-list-link">system-requirements</a></li><li class="nav-list-item"><a href="/docs/installation-instructions.html" class="nav-list-link">installation-instructions</a></li><li class="nav-list-item"><a href="/docs/folders-and-placeholders.html" class="nav-list-link">folders-and-placeholders</a></li><li class="nav-list-item"><a href="/docs/configuration-file-editor.html" class="nav-list-link">configuration-file-editor</a></li><li class="nav-list-item"><a href="/docs/known-issues.html" class="nav-list-link">known-issues</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in user-guide category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/user-guide.html" class="nav-list-link">user-guide</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/user-guide-geodms-gui.html" class="nav-list-link">user-guide-geodms-gui</a></li><li class="nav-list-item"><a href="/docs/user-guide-geodms-gui-older-variants-(delphi).html" class="nav-list-link">user-guide-geodms-gui-older-variants-(delphi)</a></li><li class="nav-list-item"><a href="/docs/user-guide-geodms-run.html" class="nav-list-link">user-guide-geodms-run</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in how-to-model category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/how-to-model.html" class="nav-list-link">how-to-model</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/configuration-basics.html" class="nav-list-link">configuration-basics</a></li><li class="nav-list-item"><a href="/docs/unit.html" class="nav-list-link">unit</a></li><li class="nav-list-item"><a href="/docs/data-source.html" class="nav-list-link">data-source</a></li><li class="nav-list-item"><a href="/docs/expression.html" class="nav-list-link">expression</a></li><li class="nav-list-item"><a href="/docs/template.html" class="nav-list-link">template</a></li><li class="nav-list-item"><a href="/docs/visualisation-style.html" class="nav-list-link">visualisation-style</a></li><li class="nav-list-item"><a href="/docs/property.html" class="nav-list-link">property</a></li></ul></li><li class="nav-list-item"><a href="/docs/value-type.html" class="nav-list-link">value-type</a></li><li class="nav-list-item"><a href="/docs/configuration-examples.html" class="nav-list-link">configuration-examples</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in operator category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/operator.html" class="nav-list-link">operator</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/arithmetic-functions.html" class="nav-list-link">arithmetic-functions</a></li><li class="nav-list-item"><a href="/docs/ordering-functions.html" class="nav-list-link">ordering-functions</a></li><li class="nav-list-item"><a href="/docs/aggregation-functions.html" class="nav-list-link">aggregation-functions</a></li><li class="nav-list-item"><a href="/docs/conversion-functions.html" class="nav-list-link">conversion-functions</a></li><li class="nav-list-item"><a href="/docs/classify-functions.html" class="nav-list-link">classify-functions</a></li><li class="nav-list-item"><a href="/docs/transcendental-functions.html" class="nav-list-link">transcendental-functions</a></li><li class="nav-list-item"><a href="/docs/predicates-functions.html" class="nav-list-link">predicates-functions</a></li><li class="nav-list-item"><a href="/docs/logical-functions.html" class="nav-list-link">logical-functions</a></li><li class="nav-list-item"><a href="/docs/relational-functions.html" class="nav-list-link">relational-functions</a></li><li class="nav-list-item"><a href="/docs/selection-functions.html" class="nav-list-link">selection-functions</a></li><li class="nav-list-item"><a href="/docs/rescale-functions.html" class="nav-list-link">rescale-functions</a></li><li class="nav-list-item"><a href="/docs/constant-functions.html" class="nav-list-link">constant-functions</a></li><li class="nav-list-item"><a href="/docs/trigonometric-functions.html" class="nav-list-link">trigonometric-functions</a></li><li class="nav-list-item"><a href="/docs/geometric-functions.html" class="nav-list-link">geometric-functions</a></li><li class="nav-list-item"><a href="/docs/network-functions.html" class="nav-list-link">network-functions</a></li><li class="nav-list-item"><a href="/docs/grid-functions.html" class="nav-list-link">grid-functions</a></li><li class="nav-list-item"><a href="/docs/string-functions.html" class="nav-list-link">string-functions</a></li><li class="nav-list-item"><a href="/docs/file,-folder-and-read-functions.html" class="nav-list-link">file,-folder-and-read-functions</a></li><li class="nav-list-item"><a href="/docs/unit-functions.html" class="nav-list-link">unit-functions</a></li><li class="nav-list-item"><a href="/docs/matrix-functions.html" class="nav-list-link">matrix-functions</a></li><li class="nav-list-item"><a href="/docs/sequence-functions.html" class="nav-list-link">sequence-functions</a></li><li class="nav-list-item"><a href="/docs/metascript-functions.html" class="nav-list-link">metascript-functions</a></li><li class="nav-list-item"><a href="/docs/allocation-functions.html" class="nav-list-link">allocation-functions</a></li><li class="nav-list-item"><a href="/docs/miscellaneous-functions.html" class="nav-list-link">miscellaneous-functions</a></li></ul></li></ul> </nav> <footer class="site-footer"> </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search GeoDMS wiki" aria-label="Search GeoDMS wiki" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://github.com/ObjectVision/GeoDMS" class="site-button" > GeoDms on Github </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <p>The Tile by Tile Heuristic is a heuristic for the <a href="discrete-allocation">discrete-allocation</a>, implemented by the Function: discrete alloc for processing large allocation problems, larger than what can fit into the Virtual Address Space of a 32-bit process.</p> <p>The discrete_alloc function supports the domain of the suitabilityMaps and atomicRegionMap to be tiled aka segmented by processing subsets of subsequent tiles as scaled versions of the total allocation where the allocations of the tiles before the current are frozen. So the processing of each tile only considers alternatives for UpdateSplitterDown within that tile. This starts with only the first tile aka tile 0, then the second tile aka tile 1 with claims scaled to the number of land units of both tiles minus what has already been allocated in the first tile, etc.</p> <p>During the processing of a tile, only that segment of the used suitability maps, the used atomic region map and the resulting landuse is FileMapped into the Virtual Address Space of the GeoDms process. The heaps for each facet also only store alternatives within that tile since reallocations of landuse in earlier tiles cannot be performed anymore since those tiles of the resulting landuse are no longer directly accessible.</p> <p>After processing a tile, the heaps for all facets are cleared to make space for allocation alternatives of the next tile.</p> <p>The shadow_prices aka spitter that result from allocating the scaled claims to a tile are used as starting point for a next tile since the random perputation of the land units among tiles guarantee that scaled versions of the allocation result in reasonable (but not necessarily perfect) splitters.</p> <p>With an unfortunate permutation of the domain, this can result in choices in the first tile(s) that are not optimal or even results in an Infeasible Solution when taking the alternatives of later tiles into account.</p> <h1 id="expected-error"> <a href="#expected-error" class="anchor-heading" aria-labelledby="expected-error"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> expected error </h1> <p>To quantify the possible deviation from a perfect (feasible + optimal) allocation, lets assume there are:</p> <ul> <li>N Land Units which is assumed to be a multiple of</li> <li>T Tiles</li> <li>2 Land Use Types: urban and other</li> <li>1 Claim Region</li> <li>1 Strict Equality claim for urban of U land units (and therefore N-U for other).</li> </ul> <p>The difference (S_io - S_iu) between suitability S_iu for urban and S_io for other land use is considered as the comparative advantage of other land use</p> <p>Note that there is 1 Urban facet facing land units with a comparative advantage of other land use (in the generalized case of k Land Use Types there are (k-1) of such Urban facets and k*(k-1) facets in total, more if there are more than 1 claim regions).</p> <p>For a perfect allocation there is one split of the comparative advantages separating urban land units from other land units with price Lambda_u (Lambda_o is assumed to be zero, since only 1 claim needs to be binding) and Lambda_u is chosen as such that there are exactly U land units with S_iu+Lambda_u &gt; S_io.</p> <p>Now let’s consider the scaled allocation of the first tile with n := (N / T) Land Units and a scaled claim for urban Land Use of (U / T).</p> <p>Take <ins><em>X</em></ins> as the stochastic number of land units in the first tile that should be allocated to Urban, which is equal to taking n times a drawing without replacement from a pot of U urban cells and (N-U) other cells, thus with an initial probability of (U/N) of drawing an Urban land unit. The expected value (the mean) of X then is n*(U/N) = U/T, since X has the <a href="http://en.wikipedia.org/wiki/Hypergeometric_distribution">Hypergeometric distribution</a> and</p> <m>P(underline{X}=k) = {(matrix{2}{1}{U k}) (matrix{2}{1})} / (matrix{2}{1}{N n})</m> <p>.</p> <p>Thus the variance of <ins><em>X</em></ins> is <m>{u (1-u) n (N-n)}/{N-1}</m> with <m>u := U/N</m></p> <p>and the standard deviation for <ins><em>X</em></ins> is the square root of (n-1)/n times the variance, which is <m>sqrt{(n-1) u (1-u) (N-n)}/{N-1}</m></p> <p>which (with larger N) approximates <m>sqrt{(1-T^{-1}) u (1-u) N}</m></p> <p>See how that approximates the <a href="http://en.wikipedia.org/wiki/Binomial_distribution">Binomial distribution</a> when T becomes large.</p> <p>And the probability of <ins><em>X</em></ins> to be exactly the claimed (U/T) is only …</p> <p>As a numeric example, take N = 2000000, U = 200000 and T = 2, thus n= 1000000 and u = 10%. Then the expected (standard) deviation from the scaled claim U/T = 100000 units in the first tile to be Urban in the in a perfect allocation is about 212 units.</p> <p>Note that this implies that an expected amount of 212 units will be mis-allocated in the first tile to meet the scaled claim of U/T units and that these mis-allocations usually represent a small total comparative disadvantage compared to the same amount of cells that will be reversely mis-allocated in the subsequent tiles. However, if suitability decreases steeply beyond the splitter as can be the case for non-urban land use if transition from urban to non-urban is prohibited, any amount of mis-allocated units in a first tile may result in much lower total suitability or even infeasibility if insufficient units remain available in the last tile to be non-urban.</p> <h1 id="possible-improvements"> <a href="#possible-improvements" class="anchor-heading" aria-labelledby="possible-improvements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> possible improvements </h1> <ol> <li>To avoid the mentioned issues, a 64 bit version of the GeoDmsRun.exe would be useful that would process an allocation without resorting to tiling.</li> <li>Within the limitations of allocating memory in a 32 bit process, one could possibly keep the allocation results of one or several already processed tiles into the virtual address space and also keep (the upper parts of) the facet-heaps that refer to reallocation options within those tiles. This would require: <ul> <li>a change to the interpretation of the indices that are stored in the facet-heaps, since now they are relative to the beginning of the current tile.</li> <li>inclusion of comparative advantages with these indices for processed tiles to allow the processed suitability map tiles to be released (for the current tile, the priority heaps only contain indices which are prioritized by looking at the corresponding suitability maps from which the comparative advantages are (re)calculated dyanmically</li> <li>the formulation and testing of a selection criterion for maintaining reallocation options into the heap (now only the absolute threshold works as a gatekeeper for allowing alternatives).</li> </ul> </li> <li>An alternative improvement would be to first process all tiles separately (as is done now) and the combine the found tile-splitters. Note that the true splitter must be within the convex hull formed by the tile-splitters (TODO: prove this). Then rerun the allocation tile by tile by using the convex hull as a threshold: alternatives that are outside the hull are never useful for the to be found true splitter. This would require: <ul> <li>a fast way to determine if a point is in (or acceptably nearby) a convex hull of T (k-1)-points or its bounding box thereof.</li> <li>some indication that this would succifiently filter the available alternatives to compensate the extra required memory for storing the selected reallocation alternatives including the comparative disadvantage for all tiles.</li> <li>An adaptation of the current Solve to deal with this inter-tile-heaps.</li> </ul> </li> </ol> <p>See also:</p> <ul> <li><a href="http://www.springerlink.com/content/7003m6n54004m004/">A shortest augmenting path algorithm for dense and sparse linear assignment problems, R. Jonker and A. Volgenant, COMPUTING Volume 38, Number 4, 325-340</a>.</li> </ul> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
